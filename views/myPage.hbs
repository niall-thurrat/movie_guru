<h1>My page</h1>

<div class="card">
  <div class="card-body">
    <h4 class="card-title">Profile</h4>
    <p class="card-text">
      Username:  {{locals.username}}<br>
      Date of birth: {{locals.dob}}<br>
      My ratings count: {{locals.data.[0].[0].my_ratings_count}} movies<br>
      Total watch time: {{locals.data.[1].[0].watch_time_sum}} minutes
    </p>
  </div>
</div><br>

<h1><span class="far fa-list-alt"></span>
    My ratings</h1>

<h6>Gets all movies a specific viewer (the logged in user) has rated</h6>

<h6>Result count: 
  {{#if locals.data.[2].length}} {{locals.data.[2].length}}
  {{else}} 0 
  {{/if}}</h6>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Title</th>
            <th>Year</th>
            <th>Length</th>
            <th>Certificate</th>
            <th>Average rating</th>
            <th>My rating</th>
            <th>Date</th>
        </tr>
    </thead>
    <tbody>
        {{#if locals.data.[2].length }}
        {{#each locals.data.[2]}}
        <tr>
            <td><a href="/rate-movies/{{this.ID}}">{{this.title}}</a></td>
            <td>{{this.year}}</td>
            <td>{{this.length}}</td>
            <td>{{this.certificate}}</td>
            <td>{{this.avg_rating}}</td>
            <td>{{this.my_rating}}</td>
            <td>{{this.date}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr>
            <td colspan="6" class="text-center text-danger">
                No movies to display.
            </td>
        </tr>
        {{/if}}
    </tbody>
</table><br>

<h1><span class="far fa-list-alt"></span>
    My top 10 directors</h1>

<h6>Gets the top 10 directors by average movie rating of a specific viewer (the logged in user)</h6>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Director</th>
            <th>My Average Rating</th>
            <th class="text-left">Ratings Count</th>
        </tr>
    </thead>
    <tbody>
        {{#if locals.data.[3].length }}
        {{#each locals.data.[3]}}
        <tr>
            <td class="w-10">{{this.director_name}}</td>
            <td class="w-20">{{this.my_dir_rating}}</td>
            <td class="w-70">{{this.ratings_count}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr>
            <td colspan="3" class="text-center text-danger">
                No directors to display.
            </td>
        </tr>
        {{/if}}
    </tbody>
</table><br>

<h1><span class="far fa-list-alt"></span>
    10 movie tips based on directors of my favorite movies</h1>

<h6>The top 10 average rated movies that a viewer has not rated 
    that have a director who is in the viewer’s top 3 directors 
    (by average movie rating)</h6>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Movie</th>
            <th>Year</th>
            <th>Average Rating</th>
            <th>Director (from my top 3)</th>
        </tr>
    </thead>
    <tbody>
        {{#if locals.data.[4].length }}
        {{#each locals.data.[4]}}
        <tr>
            <td><a href="/rate-movies/{{this.ID}}">{{this.title}}</a></td>
            <td>{{this.year}}</td>
            <td>{{this.avg_rating}}</td>
            <td>{{this.director_name}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr>
            <td colspan="3" class="text-center text-danger">
                No movies to display.
            </td>
        </tr>
        {{/if}}
    </tbody>
</table><br>

<h1><span class="far fa-list-alt"></span>
    My top 10 actors</h1>

<h6>Gets the top 10 actors by average movie rating of a specific viewer (the logged in user)</h6>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Actor</th>
            <th>My Average Rating</th>
            <th class="text-left">Ratings Count</th>
        </tr>
    </thead>
    <tbody>
        {{#if locals.data.[5].length }}
        {{#each locals.data.[5]}}
        <tr>
            <td class="w-10">{{this.actor_name}}</td>
            <td class="w-20">{{this.my_act_rating}}</td>
            <td class="w-70">{{this.ratings_count}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr>
            <td colspan="3" class="text-center text-danger">
                No actors to display.
            </td>
        </tr>
        {{/if}}
    </tbody>
</table><br>

<h1><span class="far fa-list-alt"></span>
    10 movie tips based on actors of my favorite movies</h1>

<h6>The top 10 average rated movies that a viewer has not rated 
    that have an actor who is in the viewer’s top 3 actors 
    (by average movie rating)</h6>

<table class="table table-striped">
    <thead>
        <tr>
            <th>Movie</th>
            <th>Year</th>
            <th>Average Rating</th>
            <th>Actor (from my top 3)</th>
        </tr>
    </thead>
    <tbody>
        {{#if locals.data.[6].length }}
        {{#each locals.data.[6]}}
        <tr>
            <td><a href="/rate-movies/{{this.ID}}">{{this.title}}</a></td>
            <td>{{this.year}}</td>
            <td>{{this.avg_rating}}</td>
            <td>{{this.actor_name}}</td>
        </tr>
        {{/each}}
        {{else}}
        <tr>
            <td colspan="3" class="text-center text-danger">
                No movies to display.
            </td>
        </tr>
        {{/if}}
    </tbody>
</table><br>